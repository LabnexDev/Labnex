import{j as e}from"./markdown-core-J3SG-zFE.js";import{r as t}from"./router-W3ruk9z3.js";import{a as s,l as r,B as a}from"../assets/index-DzQGG0sq.js";import{C as n}from"./Card-DNmxhqo8.js";import{F as o}from"./ClockIcon-Cv-9l8Jz.js";import{F as i}from"./ArrowPathIcon-BvHG8ZBL.js";import"./react-core-eVk5PToZ.js";import"./markdown-syntax-D_e3LpQv.js";import"./query-DQpHUI-d.js";import"./api-axios-ztdpVPaQ.js";import"./animations-framer-BqiiQv6P.js";import"./other-heavy-BrS_fVLY.js";import"./forms-hook-uaZDsLJv.js";import"./forms-resolvers-o9eYnsGV.js";import"./forms-zod-BHhVsmmU.js";function d({title:e,titleId:s,...r},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),e?t.createElement("title",{id:s},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15M9 12l3 3m0 0 3-3m-3 3V2.25"}))}const l=t.forwardRef(d),c="/bots",m="labnexAI",g=e=>{if("number"!=typeof e||e<0)return"N/A";let t=Math.floor(e/1e3),s=Math.floor(t/60),r=Math.floor(s/60);const a=Math.floor(r/24);t%=60,s%=60,r%=24;const n=[];return a>0&&n.push(`${a}d`),r>0&&n.push(`${r}h`),s>0&&n.push(`${s}m`),(t>0||0===n.length)&&n.push(`${t}s`),n.join(" ")||"0s"},u=()=>{const[d,u]=t.useState(null),[x,b]=t.useState(!0),[h,f]=t.useState(!1),[p,w]=t.useState(null),y=t.useCallback(async e=>{e?.showLoadingIndicator&&b(!0);try{const t=await(async e=>{try{return(await s.get(`${c}/${e}/status`)).data}catch(p){throw new Error(p.response?.data?.message||`Failed to fetch status for ${e}`)}})(m);u(t),e?.showLoadingIndicator&&w(null)}catch(t){e?.showLoadingIndicator&&w(t.message||"Failed to fetch bot status. Is the backend running?"),u(e=>({...e||{botId:m,status:"unknown",pid:void 0,uptime:void 0,startTime:void 0,messagesSent:0,messagesReceived:0},status:"error",message:t.message||"Bot status fetch failed.",messagesSent:e?.messagesSent??0,messagesReceived:e?.messagesReceived??0}))}finally{e?.showLoadingIndicator&&b(!1)}},[]);t.useEffect(()=>{y({showLoadingIndicator:!0});const e=setInterval(()=>{y({showLoadingIndicator:!1})},1e4);return()=>clearInterval(e)},[y]);let j="Loading status...",v="bg-gray-500",k="text-gray-400";if(!d&&x)j="Initializing...";else if(d)switch(d.status){case"running":j=`Online (PID: ${d.pid||"N/A"})`,v="bg-green-500",k="text-green-400";break;case"stopped":j="Offline",v="bg-red-500",k="text-red-400";break;case"starting":j=d.message||"Starting...",v="bg-yellow-500",k="text-yellow-400";break;case"error":j=`Error: ${d.message||"Unknown error"}`,v="bg-red-700",k="text-red-500";break;case"unknown":j=`Unknown (${d.message||"Could not determine status"})`,v="bg-purple-500",k="text-purple-400";break;default:j="Status N/A",v="bg-gray-600",k="text-gray-500"}return e.jsxs("div",{className:"p-6 min-h-screen bg-[var(--lnx-bg)] text-gray-900 dark:text-gray-100 dark:bg-gradient-to-b dark:from-gray-900 dark:to-gray-800",children:[e.jsx("h1",{className:"text-3xl font-semibold mb-8",children:"Discord Bot Integration"}),e.jsxs(n,{className:"max-w-lg shadow-xl bg-[var(--lnx-surface)] dark:bg-gray-800 border border-[var(--lnx-border)] dark:border-gray-700",children:[e.jsx(n.Title,{className:"text-xl font-semibold text-white border-b border-gray-700 pb-4 mb-5",children:"Labnex AI Bot Management"}),e.jsxs(n.Content,{className:"space-y-6",children:[p&&e.jsxs("p",{className:"text-red-400 bg-red-900/50 p-3 rounded-md text-sm border border-red-700",children:["Error: ",p]}),e.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-[var(--lnx-surface)] dark:bg-gray-750 rounded-lg border border-[var(--lnx-border)] dark:border-gray-600",children:[e.jsx("span",{className:`w-4 h-4 rounded-full ${v} ring-2 ring-offset-2 ring-offset-gray-750 ${"running"===d?.status||"starting"===d?.status?"animate-pulse":""}`,title:`Status: ${d?.status}`}),e.jsx("p",{className:`text-lg font-medium ${k}`,children:j})]}),"running"===d?.status&&void 0!==d.uptime&&e.jsxs("div",{className:"p-4 bg-[var(--lnx-surface)] dark:bg-gray-750 rounded-lg border border-[var(--lnx-border)] dark:border-gray-600",children:[e.jsxs("h3",{className:"text-md font-semibold text-gray-200 mb-2 flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-2 text-blue-400"})," Current Session Uptime"]}),e.jsx("p",{className:"text-2xl text-blue-300 font-mono tracking-wide",children:g(d.uptime)})]}),"running"===d?.status&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(n,{className:"bg-[var(--lnx-surface)] dark:bg-gray-750 p-3 border border-[var(--lnx-border)] dark:border-gray-600 shadow-md",children:[e.jsxs(n.Title,{className:"text-sm font-medium text-gray-300 flex items-center mb-1",children:[e.jsx(r,{className:"w-4 h-4 mr-2 text-green-400"})," Messages Sent"]}),e.jsx(n.Content,{className:"text-xl font-semibold text-green-300",children:d.messagesSent})]}),e.jsxs(n,{className:"bg-[var(--lnx-surface)] dark:bg-gray-750 p-3 border border-[var(--lnx-border)] dark:border-gray-600 shadow-md",children:[e.jsxs(n.Title,{className:"text-sm font-medium text-gray-300 flex items-center mb-1",children:[e.jsx(l,{className:"w-4 h-4 mr-2 text-purple-400"})," Messages Received"]}),e.jsx(n.Content,{className:"text-xl font-semibold text-purple-300",children:d.messagesReceived})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 pt-5 border-t border-gray-700",children:[e.jsx(a,{onClick:async()=>{f(!0),w(null);try{const e=await(async e=>{try{return(await s.post(`${c}/${e}/start`)).data}catch(p){throw new Error(p.response?.data?.message||`Failed to start ${e}`)}})(m);u({botId:m,status:"starting",message:e.message,startTime:e.startTime,messagesSent:0,messagesReceived:0}),setTimeout(()=>y({showLoadingIndicator:!1}),2e3)}catch(e){w(e.message||"Failed to start bot."),y({showLoadingIndicator:!1})}finally{f(!1)}},disabled:x||h||"running"===d?.status||"starting"===d?.status,variant:"primary",className:"w-full sm:w-auto flex-grow sm:flex-grow-0",children:h&&"running"!==d?.status&&"starting"!==d?.status?"Starting...":"Start Bot"}),e.jsx(a,{onClick:async()=>{f(!0),w(null);try{await(async e=>{try{return(await s.post(`${c}/${e}/stop`)).data}catch(p){throw new Error(p.response?.data?.message||`Failed to stop ${e}`)}})(m),u(e=>e?{...e,status:"stopped",uptime:void 0,startTime:void 0,pid:void 0}:null),setTimeout(()=>y({showLoadingIndicator:!1}),2e3)}catch(e){w(e.message||"Failed to stop bot."),y({showLoadingIndicator:!1})}finally{f(!1)}},disabled:x||h||"stopped"===d?.status||"error"===d?.status||"unknown"===d?.status,variant:"danger",className:"w-full sm:w-auto flex-grow sm:flex-grow-0",children:h&&"running"===d?.status?"Stopping...":"Stop Bot"}),e.jsxs(a,{onClick:()=>y({showLoadingIndicator:!0}),disabled:h,variant:"secondary",className:"w-full sm:w-auto flex-grow sm:flex-grow-0 flex items-center justify-center",children:[e.jsx(i,{className:"w-5 h-5 mr-2 "+(x&&!h?"animate-spin":"")}),x&&!h?"Refreshing...":"Refresh Status"]})]}),e.jsx("p",{className:"text-xs text-gray-500 pt-2 text-center sm:text-left",children:"This bot leverages ChatGPT to answer questions about Labnex. Ensure backend environment variables for Discord and OpenAI are correctly configured."})]})]})]})};export{u as default};
