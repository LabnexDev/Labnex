import{r as e}from"./router-W3ruk9z3.js";import{b as a,u as t}from"./query-DQpHUI-d.js";import{a as r}from"../assets/index-DzQGG0sq.js";import{b as s}from"./projects-C7_LdZWl.js";import{j as n}from"./markdown-core-J3SG-zFE.js";const o={},c=e=>{const a=o[e];if(!a)return!1;return Date.now()-a.timestamp<6e4},l=e=>{const a=o[e];if(!a)return!1;return Date.now()-a.timestamp<1e3},u=(e,a)=>{o[e]={timestamp:Date.now(),response:a}},i=(e,a=1,t=10)=>({data:e,total:e.length,page:a,totalPages:Math.ceil(e.length/t)}),g=async e=>{const a=`projects-${JSON.stringify(e)}`;if(c(a))return o[a].response;if(l(a))return o[a]?o[a].response:{data:[],total:0,page:e.page||1,totalPages:0};try{if(!e.query&&!e.status){const t=await s(),r=i(t,e.page||1,e.limit||10);return u(a,r),r}const t=await r.get("/search/projects",{params:e});return u(a,t.data),t.data}catch(t){if(o[a])return o[a].response;try{const a=await s();return i(a,e.page||1,e.limit||10)}catch(n){return{data:[],total:0,page:e.page||1,totalPages:0}}}},d=async e=>{const a=`test-cases-${JSON.stringify(e)}`;if(c(a))return o[a].response;if(l(a))return o[a]?o[a].response:{data:[],total:0,page:e.page||1,totalPages:0};try{const t=await r.get("/search/test-cases",{params:e});return u(a,t.data),t.data}catch(t){return o[a]?o[a].response:{data:[],total:0,page:e.page||1,totalPages:0}}};function p({type:r,initialParams:s={}}){const n=a(),[o,c]=e.useState({page:1,limit:10,sortBy:"createdAt",sortOrder:"desc",...s}),l=e.useRef(!1),u=e.useRef(!1),i=e.useMemo(()=>JSON.stringify(o),[o]),p=e.useMemo(()=>!!o.query||!!o.status||1!==o.page,[o.query,o.status,o.page]),{data:m,isLoading:y,error:f}=t({queryKey:[r,i],queryFn:async()=>{l.current=!0;try{return"projects"===r?await g(o):await d(o)}catch(e){throw e}},enabled:!l.current||p,staleTime:6e4,gcTime:3e5,retry:1,retryDelay:2e3,placeholderData:{data:[],total:0,page:o.page||1,totalPages:0},refetchOnWindowFocus:!1});e.useEffect(()=>{p&&!u.current&&(l.current=!1),u.current=p},[p]);const h=e.useCallback(e=>{c(a=>({...a,...e,page:1}))},[]),b=e.useCallback(e=>{c(a=>({...a,page:e}))},[]),x=e.useCallback(()=>{n.removeQueries({queryKey:[r]}),l.current=!1,u.current=!1,c({page:1,limit:10,sortBy:"createdAt",sortOrder:"desc",...s})},[n,r,s]);return{data:m,isLoading:y,error:f,params:o,updateParams:h,setPage:b,clearSearch:x}}const m=({onSearch:a,placeholder:t="Search...",className:r=""})=>{const[s,o]=e.useState(""),c=function(a,t){const[r,s]=e.useState(a);return e.useEffect(()=>{const e=setTimeout(()=>{s(a)},t);return()=>{clearTimeout(e)}},[a,t]),r}(s,500),l=e.useRef(!0),u=e.useRef(""),i=e.useCallback(e=>{o(e)},[]);return e.useEffect(()=>{if(l.current)return l.current=!1,void(u.current=c);u.current!==c&&(u.current=c,a(c))},[c,a]),n.jsxs("div",{className:`relative ${r}`,children:[n.jsx("input",{type:"text",value:s,onChange:e=>i(e.target.value),placeholder:t,className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 transition-all duration-200"}),n.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:n.jsx("svg",{className:"w-5 h-5 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})};function y({label:e,options:a,value:t,onChange:r,className:s="",selectClassName:o=""}){return n.jsxs("div",{className:`flex flex-col gap-1 ${s}`,children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-0.5",children:e}),n.jsxs("select",{value:t,onChange:e=>r(e.target.value),className:`w-full px-3 py-2 rounded-lg \n                   bg-white dark:bg-gray-800 \n                   border border-gray-300 dark:border-gray-600 \n                   text-gray-900 dark:text-gray-100 \n                   focus:outline-none focus:ring-2 focus:border-transparent \n                   focus:ring-blue-500 dark:focus:ring-blue-500 \n                   transition-colors duration-200 ease-in-out \n                   appearance-none pr-8 ${o}`,children:[n.jsx("option",{value:"",className:"text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800",children:"All"}),a.map(e=>n.jsx("option",{value:e.value,className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:e.label},e.value))]})]})}export{y as F,m as S,p as u};
