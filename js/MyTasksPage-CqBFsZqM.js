import{j as e}from"./markdown-core-J3SG-zFE.js";import{r as t,u as s,L as a}from"./router-W3ruk9z3.js";import{u as r,k as l}from"./query-DQpHUI-d.js";import{T as o,a as i,b as c}from"./tasks-DdZhjJsD.js";import{b as n}from"./projects-C7_LdZWl.js";import{e as d,B as m}from"../assets/index-DzQGG0sq.js";import{c as x}from"./other-heavy-BrS_fVLY.js";import{F as p}from"./EyeIcon-B7Oi3wZ2.js";import{F as h}from"./DocumentMagnifyingGlassIcon-BPjZ9nSv.js";import"./react-core-eVk5PToZ.js";import"./markdown-syntax-D_e3LpQv.js";import"./api-axios-ztdpVPaQ.js";import"./animations-framer-BqiiQv6P.js";import"./forms-hook-uaZDsLJv.js";import"./forms-resolvers-o9eYnsGV.js";import"./forms-zod-BHhVsmmU.js";function u({title:e,titleId:s,...a},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?t.createElement("title",{id:s},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const j=t.forwardRef(u);function g({title:e,titleId:s,...a},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?t.createElement("title",{id:s},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const f=t.forwardRef(g);function b({title:e,titleId:s,...a},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?t.createElement("title",{id:s},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const v=t.forwardRef(b),y=()=>{const u=s(),[g,b]=t.useState({}),[y,w]=t.useState("createdAt"),[N,k]=t.useState("desc"),{data:C,isLoading:E,isError:A,error:D,isFetching:I}=r({queryKey:["myAssignedTasks",g,y,N],queryFn:async()=>{const e=await c(g,y,N);if(Array.isArray(e)){return{tasks:e,total:e.length}}return e},placeholderData:l}),L=C?.tasks,{data:F,isLoading:P}=r({queryKey:["projectsListForFilter"],queryFn:()=>n()}),_=e=>{const{name:t,value:s}=e.target;b(e=>({...e,[t]:""===s?void 0:s}))},B=()=>{b({});const e=document.getElementById("filter-project"),t=document.getElementById("filter-status"),s=document.getElementById("filter-priority");e&&(e.value=""),t&&(t.value=""),s&&(s.value=""),x.success("Filters cleared",{id:"filters-cleared"})};if(E&&!I)return e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-[60vh]",children:[e.jsxs("svg",{className:"animate-spin h-12 w-12 text-blue-400 mb-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("p",{className:"text-slate-200 text-xl font-semibold",children:"Loading Your Tasks..."}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Fetching your assigned tasks, please wait."})]});if(A)return e.jsxs("div",{className:"card p-10 max-w-lg mx-auto text-center",children:[e.jsx(d,{className:"h-16 w-16 text-red-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold text-red-300 mb-2",children:"Error Loading Tasks"}),e.jsx("p",{className:"text-slate-300 text-center",children:"Could not fetch your assigned tasks. Please try again later."}),D?.message&&e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Details: ",D.message]})]});const M="w-full p-2.5 bg-slate-700/50 border border-slate-600 text-slate-100 placeholder-slate-400 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm appearance-none text-sm";return e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsx("div",{className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 via-blue-500 to-indigo-500",children:"My Assigned Tasks"})}),e.jsxs("div",{className:"card p-5 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-project",className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Project"}),e.jsxs("select",{id:"filter-project",name:"projectId",onChange:_,value:g.projectId||"",className:M,disabled:P,children:[e.jsx("option",{value:"",className:"bg-slate-800 text-slate-400",children:"All Projects"}),F?.map(t=>t&&t._id?e.jsx("option",{value:t._id,className:"bg-slate-800 text-slate-100",children:t.name||"Unnamed Project"},t._id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-status",className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Status"}),e.jsxs("select",{id:"filter-status",name:"status",onChange:_,value:g.status||"",className:M,children:[e.jsx("option",{value:"",className:"bg-slate-800 text-slate-400",children:"All Statuses"}),Object.values(o).map(t=>e.jsx("option",{value:t,className:"bg-slate-800 text-slate-100",children:t.replace("_"," ")},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-priority",className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Priority"}),e.jsxs("select",{id:"filter-priority",name:"priority",onChange:_,value:g.priority||"",className:M,children:[e.jsx("option",{value:"",className:"bg-slate-800 text-slate-400",children:"All Priorities"}),Object.values(i).map(t=>e.jsx("option",{value:t,className:"bg-slate-800 text-slate-100",children:t},t))]})]}),e.jsxs(m,{onClick:B,variant:"secondary",className:"h-10 w-full lg:w-auto shadow-sm hover:shadow-md focus:ring-offset-slate-800",children:[e.jsx(d,{className:"h-5 w-5 mr-1.5"})," Clear Filters"]})]}),e.jsxs("div",{className:"mt-5 flex flex-wrap gap-x-3 gap-y-2 items-center border-t border-slate-700/80 pt-4",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300 mr-2",children:"Sort by:"}),["createdAt","dueDate","priority"].map(t=>e.jsx(m,{variant:y===t?"primary":"tertiary",size:"sm",onClick:()=>(e=>{y===e?k(e=>"asc"===e?"desc":"asc"):(w(e),k("asc"))})(t),className:"capitalize "+(y===t?"shadow-md hover:shadow-blue-500/50":"hover:bg-slate-700/70"),rightIcon:y===t?"asc"===N?e.jsx(f,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4 opacity-50"}),children:t.replace("createdAt","Date Created").replace("dueDate","Due Date")},t))]})]}),I&&e.jsxs("div",{className:"p-6 md:p-8 flex flex-col justify-center items-center text-slate-400",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-400 mb-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("p",{children:"Updating task list..."})]}),!I&&L&&L.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 md:gap-6 "+(I?"opacity-50":""),children:L.map(t=>{return e.jsxs("div",{className:"card hover:shadow-glow-brand transition-shadow duration-300 cursor-pointer hover:-translate-y-1 flex flex-col justify-between group",onClick:()=>u(`/projects/${t.project&&"object"==typeof t.project?t.project._id:t.project}/tasks`),title:`View tasks for project: ${t.project&&"object"==typeof t.project?t.project.name:"N/A"}`,children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-blue-300 group-hover:text-blue-200 transition-colors duration-150 truncate pr-2",children:t.title}),e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1.5",children:[e.jsx("span",{className:"px-2.5 py-1 rounded-full text-[0.68rem] leading-tight font-medium text-white shadow-sm transition-colors duration-150 "+(r=t.status,r===o.DONE?"bg-green-500 hover:bg-green-400":r===o.IN_PROGRESS?"bg-yellow-500 hover:bg-yellow-400":r===o.BLOCKED?"bg-red-600 hover:bg-red-500":r===o.IN_REVIEW?"bg-purple-500 hover:bg-purple-400":r===o.CANCELLED?"bg-slate-500 hover:bg-slate-400":"bg-sky-600 hover:bg-sky-500"),children:t.status.replace("_"," ")}),e.jsx("span",{className:"px-2.5 py-1 rounded-full text-[0.68rem] leading-tight font-medium text-white shadow-sm transition-colors duration-150 "+(s=t.priority,s===i.HIGH?"bg-red-500 hover:bg-red-400":s===i.MEDIUM?"bg-orange-400 hover:bg-orange-300":"bg-sky-500 hover:bg-sky-400"),children:t.priority})]})]}),e.jsxs(a,{to:`/projects/${t.project&&"object"==typeof t.project?t.project._id:t.project}`,onClick:e=>e.stopPropagation(),className:"text-xs text-slate-400 hover:text-sky-400 hover:underline transition-colors duration-150 mb-2 block truncate font-medium",title:`Go to project: ${t.project&&"object"==typeof t.project?t.project.name:"N/A"}`,children:["Project: ",t.project&&"object"==typeof t.project?t.project.name:"Unknown Project"]}),e.jsx("p",{className:"text-slate-300/80 mb-4 text-sm min-h-[40px] overflow-hidden line-clamp-2 leading-relaxed group-hover:text-slate-200 transition-colors duration-150",children:t.description||"No description provided."}),e.jsxs("div",{className:"space-y-1.5 text-xs text-slate-400/90 mb-4 border-t border-slate-700/80 pt-3 mt-3",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-500",children:"Reporter:"})," ",t.createdBy?.name||"Unknown Reporter"]}),t.dueDate&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-slate-500",children:"Due:"})," ",new Date(t.dueDate).toLocaleDateString()]})]}),t.testCases&&t.testCases.length>0&&e.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-700/80",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1.5 font-semibold",children:"Related Test Cases:"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[t.testCases.slice(0,2).map(t=>e.jsx("span",{className:"px-2 py-1 text-[0.7rem] bg-slate-700 hover:bg-slate-600/70 text-blue-300 transition-colors duration-150 rounded-md truncate cursor-default shadow-sm",title:t.title,children:t.title},t._id)),t.testCases.length>2&&e.jsxs("span",{className:"px-2 py-1 text-[0.7rem] bg-slate-600 text-blue-200 rounded-md cursor-default shadow-sm",children:["+ ",t.testCases.length-2," more"]})]})]})]}),e.jsx("div",{className:"mt-5 pt-4 border-t border-slate-700/80 flex justify-end space-x-2 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity duration-300",children:e.jsx(m,{variant:"primary",size:"sm",onClick:e=>{e.stopPropagation(),u(`/projects/${t.project&&"object"==typeof t.project?t.project._id:t.project}/tasks`)},className:"focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 focus:ring-offset-slate-800 shadow-md hover:shadow-lg hover:shadow-sky-500/50",leftIcon:e.jsx(p,{className:"h-4 w-4"}),children:"View in Project"})})]},t._id);var s,r})}):!I&&e.jsxs("div",{className:"card text-center py-16 min-h-[60vh] flex flex-col items-center justify-center gap-4",children:[e.jsx(h,{className:"h-16 w-16 text-slate-500 mx-auto mb-5"}),e.jsx("p",{className:"text-slate-200 text-xl font-semibold",children:"No tasks assigned to you match the current filters."}),e.jsx("p",{className:"text-slate-400/80 mt-1.5 mb-6 text-sm max-w-md mx-auto",children:"Try adjusting your filters or check back later. If you have no tasks, enjoy the quiet moment!"}),e.jsxs(m,{onClick:B,variant:"primary",size:"lg",className:"shadow-md hover:shadow-blue",children:[e.jsx(d,{className:"h-5 w-5 mr-2"})," Clear All Filters"]})]})]})};export{y as default};
