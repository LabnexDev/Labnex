import{j as e}from"./markdown-core-J3SG-zFE.js";import{r as s,u as a,c as t}from"./router-W3ruk9z3.js";import{b as r,u as l}from"./query-DQpHUI-d.js";import{u as d,S as o,F as i}from"./Filter-BWht7uWJ.js";import{a as n}from"./projects-C7_LdZWl.js";import{F as c}from"./CalendarDaysIcon-DBg9AJpN.js";import{L as m,B as x}from"../assets/index-DzQGG0sq.js";import{E as u}from"./ErrorMessage-Bz_uBxpF.js";import{c as g}from"./other-heavy-BrS_fVLY.js";import{F as p}from"./ArrowUturnLeftIcon-mLw3q7z9.js";import{F as h}from"./PlusIcon-DmexcfTS.js";import{F as y}from"./DocumentMagnifyingGlassIcon-BPjZ9nSv.js";import"./react-core-eVk5PToZ.js";import"./markdown-syntax-D_e3LpQv.js";import"./api-axios-ztdpVPaQ.js";import"./animations-framer-BqiiQv6P.js";import"./forms-hook-uaZDsLJv.js";import"./forms-resolvers-o9eYnsGV.js";import"./forms-zod-BHhVsmmU.js";function j({title:e,titleId:a,...t},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},t),e?s.createElement("title",{id:a},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const f=s.forwardRef(j),b={PASSED:"bg-green-100 text-green-700 dark:bg-green-600/30 dark:text-green-300",FAILED:"bg-red-100 text-red-700 dark:bg-red-600/30 dark:text-red-300",PENDING:"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/30 dark:text-yellow-300"},v={HIGH:"bg-red-100 text-red-700 dark:bg-red-600/30 dark:text-red-300",MEDIUM:"bg-yellow-100 text-yellow-700 dark:bg-yellow-500/30 dark:text-yellow-300",LOW:"bg-blue-100 text-blue-700 dark:bg-blue-600/30 dark:text-blue-300"};function k({testCase:s}){const t=a();return e.jsxs("div",{onClick:()=>t(`/projects/${s.project._id}/test-cases/${s._id}`),className:"card p-5 group flex flex-col justify-between h-full cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-glow-blue-md",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[s.taskReferenceId&&e.jsx("span",{className:"block text-xs font-mono text-gray-500 dark:text-gray-400 mb-1 bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded-sm inline-block",children:s.taskReferenceId}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors duration-200 line-clamp-2",children:s.title})]}),e.jsxs("div",{className:"flex flex-col space-y-1.5 items-end flex-shrink-0 ml-2",children:[e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold transition-colors duration-200 ${b[s.status]||"bg-gray-100 text-gray-700 dark:bg-gray-600 dark:text-gray-200"}`,children:s.status}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold transition-colors duration-200 ${v[s.priority]||"bg-gray-100 text-gray-700 dark:bg-gray-600 dark:text-gray-200"}`,children:s.priority})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-3",children:s.description})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-gray-200 dark:border-gray-700/60 text-xs text-gray-500 dark:text-gray-400 space-y-1.5",children:[s.assignedTo&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-3.5 w-3.5 mr-1.5 flex-shrink-0"}),e.jsxs("span",{children:["Assigned to: ",s.assignedTo.name]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-3.5 w-3.5 mr-1.5 flex-shrink-0"}),e.jsxs("span",{children:["Created by: ",s.createdBy.name]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"h-3.5 w-3.5 mr-1.5 flex-shrink-0"}),e.jsxs("span",{children:["Last updated: ",new Date(s.updatedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]})]})}const w=[{value:"title",label:"Title"},{value:"createdAt",label:"Created Date"},{value:"updatedAt",label:"Last Updated"},{value:"priority",label:"Priority"},{value:"status",label:"Status"}],N=[{value:"ALL",label:"All Statuses"},{value:"PASSED",label:"Passed"},{value:"FAILED",label:"Failed"},{value:"PENDING",label:"Pending"}];function C(){const{id:c}=t(),j=a(),f=r(),{data:b}=l({queryKey:["project",c],queryFn:()=>c&&"undefined"!==c?n(c):Promise.reject(new Error("Invalid project ID")),enabled:!!c&&"undefined"!==c,staleTime:1/0}),{data:v,isLoading:C,error:I,params:A,updateParams:L,setPage:E,clearSearch:P}=d({type:"testCases",initialParams:{projectId:c,sortBy:"updatedAt",sortOrder:"desc",status:void 0,page:1,limit:9}});s.useEffect(()=>()=>{},[P,f]),s.useEffect(()=>{c&&"undefined"!==c||(g.error("Invalid project context. Redirecting to dashboard."),j("/dashboard"))},[c,j]);if(C&&(!v||!v.data||0===v.data.length))return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsx(m,{size:"lg"})});if(I)return e.jsx(u,{message:I.message||"Failed to load test cases. Please check your connection or try again later.",title:"Error Loading Test Cases"});const D=v?.data||[],S=v?.totalPages||0,F=A.page||1,T=b?`Test Cases for ${b.name}`:"Test Cases";return e.jsxs("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-2",children:[e.jsxs("div",{children:[e.jsx(x,{variant:"tertiary",onClick:()=>{j(c&&"undefined"!==c?`/projects/${c}`:"/dashboard")},leftIcon:e.jsx(p,{className:"h-5 w-5"}),className:"text-sm mb-2 p-0 hover:bg-transparent dark:hover:bg-transparent focus:ring-0 text-blue-600 dark:text-blue-400 hover:underline",children:"Back to Project Details"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:T})]}),e.jsx(x,{variant:"primary",onClick:()=>{c&&"undefined"!==c?j(`/projects/${c}/test-cases/new`):g.error("Cannot add test case: Invalid project context.")},leftIcon:e.jsx(h,{className:"h-5 w-5"}),children:"Add New Test Case"})]}),e.jsxs("div",{className:"card p-4 sm:p-6 relative",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-6",children:[e.jsx("div",{className:"w-full sm:max-w-xs",children:e.jsx(o,{placeholder:"Search by title, description...",onSearch:e=>L({query:e,page:1})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[e.jsx(i,{label:"Sort by",options:w,value:A.sortBy||"updatedAt",onChange:e=>L({sortBy:e,page:1}),className:"w-full sm:w-auto"}),e.jsx(i,{label:"Status",options:N,value:A.status||"ALL",onChange:e=>L({status:"ALL"===e?void 0:e,page:1}),className:"w-full sm:w-auto"})]})]}),C&&v&&v.data&&v.data.length>0&&e.jsx("div",{className:"absolute top-4 right-4 z-10 p-1 bg-gray-100/50 dark:bg-gray-800/50 rounded-full shadow",children:e.jsx(m,{size:"sm"})}),0!==D.length||C?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 "+(C&&v&&v.data&&v.data.length>0?"opacity-70":""),children:D.map(s=>e.jsx(k,{testCase:s},s._id))}):e.jsxs("div",{className:"text-center py-10 sm:py-16 card border-dashed border-gray-300 dark:border-gray-600 bg-gray-50/50 dark:bg-gray-800/30",children:[e.jsx(y,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),e.jsx("h3",{className:"mt-2 text-xl font-semibold text-gray-900 dark:text-white",children:"No Test Cases Found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:A.query?`No test cases matched your search for "${A.query}".`:A.status&&"ALL"!==A.status?`No test cases found with status "${A.status}".`:"Get started by adding a new test case."}),e.jsx("div",{className:"mt-6",children:e.jsx(x,{variant:"primary",onClick:()=>{c&&"undefined"!==c?j(`/projects/${c}/test-cases/new`):g.error("Cannot add test case: Invalid project context.")},leftIcon:e.jsx(h,{className:"h-5 w-5"}),children:"Add New Test Case"})})]}),S>1&&e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{onClick:()=>E(F-1),disabled:1===F||C,variant:"secondary",size:"sm",children:"Previous"}),Array.from({length:S},(e,s)=>s+1).map(s=>e.jsx(x,{onClick:()=>E(s),variant:s===F?"primary":"secondary",size:"sm",disabled:C,className:"min-w-[36px]",children:s},s)),e.jsx(x,{onClick:()=>E(F+1),disabled:F===S||C,variant:"secondary",size:"sm",children:"Next"})]})]})]})}export{C as TestCaseList};
