import{j as s}from"./markdown-core-J3SG-zFE.js";import{r as e}from"./router-W3ruk9z3.js";import{b as i,u as r,c as n}from"./query-DQpHUI-d.js";import{u as a,g as t}from"./discordIntegration-CGrSMky1.js";import{L as o,B as c,n as d}from"../assets/index-DzQGG0sq.js";import{C as l}from"./Card-DNmxhqo8.js";import{M as m}from"./Modal-B3wKZjd4.js";import{V as x}from"./other-heavy-BrS_fVLY.js";import{F as j}from"./LinkIcon-_iA0Y722.js";import{F as p}from"./UserCircleIcon-CEdGODWc.js";import{f as u}from"./utils-date-g2md2ZC7.js";import{F as h}from"./TrashIcon-S028_C7U.js";import"./react-core-eVk5PToZ.js";import"./markdown-syntax-D_e3LpQv.js";import"./api-axios-ztdpVPaQ.js";import"./animations-framer-BqiiQv6P.js";import"./forms-hook-uaZDsLJv.js";import"./forms-resolvers-o9eYnsGV.js";import"./forms-zod-BHhVsmmU.js";import"./ui-headless-BOwnFwqN.js";import"./XMarkIcon-Bv5SMunc.js";const f=()=>{const f=i(),[y,k]=e.useState(!1),[g,N]=e.useState(null),{data:v,isLoading:w,error:C}=r({queryKey:["linkedDiscordAccounts"],queryFn:t}),D=n({mutationFn:a,onSuccess:()=>{x.success("Discord account unlinked successfully!"),f.invalidateQueries({queryKey:["linkedDiscordAccounts"]}),k(!1),N(null)},onError:s=>{x.error(s.message||"Failed to unlink account."),k(!1)}});return w?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx(o,{size:"lg"})}):C?s.jsx("div",{className:"p-4 text-center text-red-500",children:s.jsxs("p",{children:["Error loading linked accounts: ",C.message]})}):s.jsxs("div",{className:"space-y-6 p-4 md:p-6",children:[s.jsx("h1",{className:"text-3xl font-semibold text-white",children:"Discord Integrations"}),s.jsx("div",{className:"mb-6",children:s.jsxs(c,{variant:"primary",onClick:()=>{const s=d();window.location.href=`${s}/integrations/discord/initiate-link`},className:"flex items-center space-x-2 glowing-button-effect",children:[s.jsx(j,{className:"h-5 w-5"}),s.jsx("span",{children:"Link New Discord Account"})]})}),s.jsxs(l,{className:"glassmorphism",children:[s.jsx(l.Title,{children:"Linked Discord Accounts"}),s.jsx(l.Content,{children:v&&v.length>0?s.jsx("ul",{className:"divide-y divide-gray-700",children:v.map(e=>s.jsxs("li",{className:"py-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(p,{className:"h-10 w-10 text-purple-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-medium text-white",children:e.discordUsername}),s.jsxs("p",{className:"text-sm text-gray-400",children:["ID: ",e.discordUserId," - Linked on: ",u(new Date(e.linkedAt),"PPP")]})]})]}),s.jsxs(c,{variant:"danger",onClick:()=>(s=>{N(s),k(!0)})(e),className:"flex items-center space-x-1.5",size:"sm",children:[s.jsx(h,{className:"h-4 w-4"}),s.jsx("span",{children:"Unlink"})]})]},e.discordUserId))}):s.jsx("p",{className:"text-gray-400 text-center py-8",children:"No Discord accounts linked yet."})})]}),g&&s.jsxs(m,{isOpen:y,onClose:()=>k(!1),title:"Confirm Unlink",children:[s.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to unlink the Discord account",s.jsxs("span",{className:"font-semibold text-white",children:[" ",g.discordUsername]})," (",g.discordUserId,")?"]}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(c,{variant:"secondary",onClick:()=>k(!1),disabled:D.isPending,children:"Cancel"}),s.jsx(c,{variant:"danger",onClick:()=>{g&&D.mutate(g.discordUserId)},isLoading:D.isPending,children:"Confirm Unlink"})]})]})]})};export{f as default};
