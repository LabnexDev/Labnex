const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/markdown-syntax-D_e3LpQv.js","js/router-W3ruk9z3.js","js/react-core-eVk5PToZ.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-core-J3SG-zFE.js";import{r as s}from"./router-W3ruk9z3.js";import{b as t,u as a,c as l}from"./query-DQpHUI-d.js";import{a as r,L as i,q as n,B as o,F as d,p as c}from"../assets/index-DzQGG0sq.js";import{b as m}from"./projects-C7_LdZWl.js";import{I as p}from"./Input-Di4d9ysK.js";import{M as x}from"./Modal-B3wKZjd4.js";import{_ as u}from"./markdown-syntax-D_e3LpQv.js";import{c as h}from"./other-heavy-BrS_fVLY.js";import{F as g}from"./PlusCircleIcon-B2u9WL21.js";import{F as j}from"./PencilIcon-CwciGq70.js";import{F as b}from"./TrashIcon-S028_C7U.js";import{F as y}from"./LightBulbIcon-DDUyBPVI.js";import"./react-core-eVk5PToZ.js";import"./api-axios-ztdpVPaQ.js";import"./animations-framer-BqiiQv6P.js";import"./forms-hook-uaZDsLJv.js";import"./forms-resolvers-o9eYnsGV.js";import"./forms-zod-BHhVsmmU.js";import"./ui-headless-BOwnFwqN.js";import"./XMarkIcon-Bv5SMunc.js";const f=async e=>(await r.post("/snippets",e)).data,N=async e=>(await r.delete(`/snippets/${e}`)).data,v=s.lazy(()=>u(()=>import("./markdown-syntax-D_e3LpQv.js").then(e=>e.gw),__vite__mapDeps([0,1,2]))),w=()=>e.jsxs("div",{className:"animate-pulse bg-slate-900 p-4 rounded",children:[e.jsx("div",{className:"h-4 bg-slate-700 rounded mb-2"}),e.jsx("div",{className:"h-4 bg-slate-700 rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-slate-700 rounded mb-2 w-1/2"})]}),k=({children:t,language:a,showLineNumbers:l=!1,wrapLines:r=!0,customStyle:i={},lineNumberStyle:n={},className:o=""})=>e.jsx(s.Suspense,{fallback:e.jsx(w,{}),children:e.jsx(v,{language:a.toLowerCase(),showLineNumbers:l,wrapLines:r,customStyle:{padding:"0.75rem",margin:0,background:"transparent",fontSize:"0.8rem",...i},lineNumberStyle:{minWidth:"2.25em",...n},className:`!bg-transparent ${o}`,children:t})}),S=()=>{const u=t(),[v,w]=s.useState(!1),[S,C]=s.useState(null),[I,F]=s.useState({title:"",description:"",language:"javascript",code:"",projectId:void 0}),[L,_]=s.useState(!1),[A,q]=s.useState(null),[z,E]=s.useState(null),[P,D]=s.useState(null),[O,T]=s.useState(!1),[$,K]=s.useState(!1),[W,B]=s.useState(null),{data:M,isLoading:Q,error:R}=a({queryKey:["snippets"],queryFn:()=>(async()=>(await r.get("/snippets",{params:{}})).data)()}),{data:H,isLoading:V}=a({queryKey:["projectsListForSnippets"],queryFn:m}),X=l({mutationFn:f,onSuccess:()=>{u.invalidateQueries({queryKey:["snippets"]}),h.success("Snippet created successfully!"),w(!1)},onError:e=>{h.error(e.response?.data?.message||"Failed to create snippet.")}}),Y=l({mutationFn:({snippetId:e,payload:s})=>(async(e,s)=>(await r.put(`/snippets/${e}`,s)).data)(e,s),onSuccess:()=>{u.invalidateQueries({queryKey:["snippets"]}),h.success("Snippet updated successfully!"),w(!1),C(null)},onError:e=>{h.error(e.response?.data?.message||"Failed to update snippet.")}}),G=l({mutationFn:N,onSuccess:()=>{u.invalidateQueries({queryKey:["snippets"]}),h.success("Snippet deleted successfully!")},onError:e=>{h.error(e.response?.data?.message||"Failed to delete snippet.")}}),J=l({mutationFn:({snippetId:e,payload:s})=>(async(e,s)=>(await r.post(`/snippets/${e}/assist`,s)).data)(e,s),onSuccess:e=>{E(e.suggestion),_(!0),h.success("AI suggestion received!"),T(!1)},onError:e=>{E(null),h.error(e.response?.data?.message||"Failed to get AI suggestion."),T(!1)}}),U=e=>{const{name:s,value:t}=e.target;F(e=>({...e,[s]:t}))},Z=()=>{C(null),F({title:"",description:"",language:"javascript",code:"",projectId:void 0}),w(!0)},ee=(e,s)=>{q(e),D(s),E(null),T(!0),J.mutate({snippetId:e._id,payload:{action:s}})};return Q&&!M?e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-[60vh]",children:[e.jsx(i,{size:"lg"}),e.jsx("p",{className:"mt-4 text-lg",children:"Loading your snippets..."})]}):e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("header",{className:"mb-6 md:mb-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-sky-400 via-cyan-300 to-teal-300 flex items-center self-start md:self-center",children:[e.jsx(n,{className:"h-8 w-8 md:h-10 md:w-10 mr-3 text-sky-400"})," Code Snippets"]}),e.jsx(o,{variant:"primary",onClick:Z,leftIcon:e.jsx(g,{className:"h-5 w-5"}),className:"shadow-md hover:shadow-sky-500/40",children:"Add Snippet"})]}),Q&&M&&e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs("div",{className:"flex items-center bg-slate-700/80 backdrop-blur-md text-slate-200 px-3 py-2 rounded-lg shadow-lg",children:[e.jsx(i,{size:"sm"}),e.jsx("span",{className:"ml-2 text-sm",children:"Refreshing snippets..."})]})}),R&&e.jsxs("div",{className:"bg-red-900/30 border border-red-700 text-red-300 px-4 py-3 rounded-lg shadow-lg flex items-center",children:[e.jsx(d,{className:"h-6 w-6 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Error Loading Snippets"}),e.jsx("p",{className:"text-sm",children:R.message||"An unknown error occurred. Please try again."})]})]}),M&&M.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:M.map(s=>e.jsxs("div",{className:"card hover:shadow-glow-blue transition-shadow duration-300 flex flex-col group",children:[e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-100 mb-1 truncate group-hover:text-sky-300 transition-colors",children:s.title}),e.jsx("p",{className:"text-xs text-slate-400 mb-2 font-mono bg-slate-700/50 px-2 py-0.5 rounded-full inline-block",children:s.language}),s.description&&e.jsx("p",{className:"text-sm text-slate-300 mb-3 line-clamp-2 h-10",children:s.description}),e.jsx("div",{className:"bg-slate-900/70 border border-slate-700 p-0 rounded-md max-h-60 overflow-y-auto mb-3 text-sm shadow-inner",style:{scrollbarWidth:"thin",scrollbarColor:"#4A5568 #1A202C"},children:e.jsx(k,{language:s.language.toLowerCase(),showLineNumbers:!1,wrapLines:!0,customStyle:{padding:"0.75rem",margin:0,background:"transparent",fontSize:"0.8rem"},lineNumberStyle:{minWidth:"2.25em"},className:"!bg-transparent",children:String(s.code).substring(0,400)+(String(s.code).length>400?"\n... (code truncated)":"")})}),s.projectId&&"object"==typeof s.projectId&&e.jsxs("p",{className:"text-xs text-slate-400 mb-3",children:["Project: ",e.jsx("span",{className:"font-medium text-slate-300 bg-slate-700 px-1.5 py-0.5 rounded",children:s.projectId.name})]})]}),e.jsxs("div",{className:"border-t border-slate-700/70 p-3 flex flex-wrap justify-end items-center gap-2",children:[e.jsxs(o,{size:"sm",variant:"tertiary",title:"AI Cleanup",className:"text-teal-400 hover:text-teal-300",onClick:()=>ee(s,"cleanup"),isLoading:O&&A?._id===s._id&&"cleanup"===P,children:[e.jsx(c,{className:"h-4 w-4 mr-1"})," Cleanup"]}),e.jsxs(o,{size:"sm",variant:"tertiary",title:"AI Fix Errors",className:"text-purple-400 hover:text-purple-300",onClick:()=>ee(s,"fix_errors"),isLoading:O&&A?._id===s._id&&"fix_errors"===P,children:[e.jsx(c,{className:"h-4 w-4 mr-1"})," Fix Errors"]}),e.jsx(o,{size:"sm",title:"Edit Snippet",className:"text-slate-400 hover:text-sky-400",onClick:()=>(e=>{C(e),F({title:e.title,description:e.description||"",language:e.language,code:e.code,projectId:"object"==typeof e.projectId&&e.projectId?e.projectId._id:"string"==typeof e.projectId?e.projectId:void 0}),w(!0)})(s),children:e.jsx(j,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",color:"danger",title:"Delete Snippet",className:"text-slate-400 hover:text-red-400",onClick:()=>(e=>{B(e),K(!0)})(s),children:e.jsx(b,{className:"h-4 w-4"})})]})]},s._id))}):!Q&&!R&&e.jsxs("div",{className:"card text-center py-16 min-h-[60vh] flex flex-col items-center justify-center gap-4",children:[e.jsx(n,{className:"h-20 w-20 text-slate-500 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-semibold text-slate-300",children:"No Snippets Here"}),e.jsx("p",{className:"text-slate-400 mt-3 max-w-md mx-auto",children:"It looks a bit empty. Start by adding your first code snippet!"}),e.jsx(o,{variant:"primary",className:"mt-8 shadow-lg hover:shadow-sky-500/50",onClick:Z,leftIcon:e.jsx(g,{className:"h-5 w-5"}),children:"Add First Snippet"})]}),v&&e.jsx(x,{isOpen:v,onClose:()=>{w(!1),C(null)},title:S?"Edit Code Snippet":"Create New Code Snippet",children:e.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!I.title||!I.language||!I.code)return void h.error("Title, language, and code are required.");const s={...I,projectId:""===I.projectId?void 0:I.projectId};S?Y.mutate({snippetId:S._id,payload:s}):X.mutate(s)},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-slate-300 mb-1",children:"Title"}),e.jsx(p,{type:"text",name:"title",id:"title",value:I.title,onChange:U,placeholder:"e.g., React Fetch Hook",required:!0,className:"w-full bg-slate-700/50 border-slate-600 text-slate-100 placeholder-slate-400 focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-slate-300 mb-1",children:"Language"}),e.jsx(p,{type:"text",name:"language",id:"language",value:I.language,onChange:U,placeholder:"e.g., javascript, python",required:!0,className:"w-full bg-slate-700/50 border-slate-600 text-slate-100 placeholder-slate-400 focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-300 mb-1",children:"Description (Optional)"}),e.jsx(p,{as:"textarea",name:"description",id:"description",value:I.description,onChange:U,placeholder:"Briefly describe what this snippet does",rows:3,className:"w-full bg-slate-700/50 border-slate-600 text-slate-100 placeholder-slate-400 focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-slate-300 mb-1",children:"Code"}),e.jsx(p,{as:"textarea",name:"code",id:"code",value:I.code,onChange:U,placeholder:"Paste your code here...",rows:10,required:!0,className:"w-full bg-slate-700/50 border-slate-600 text-slate-100 placeholder-slate-400 font-mono text-sm focus:ring-sky-500 focus:border-sky-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"projectId",className:"block text-sm font-medium text-slate-300 mb-1",children:"Link to Project (Optional)"}),e.jsxs("select",{name:"projectId",id:"projectId",value:I.projectId||"",onChange:U,className:"w-full p-3 bg-slate-700/50 border border-slate-600 rounded-md text-slate-100 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors",children:[e.jsx("option",{value:"",className:"bg-slate-800",children:"No Project"}),V&&e.jsx("option",{value:"",disabled:!0,className:"bg-slate-800",children:"Loading projects..."}),H&&H.map(s=>e.jsx("option",{value:s._id,className:"bg-slate-800",children:s.name},s._id))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[e.jsx(o,{type:"button",variant:"secondary",onClick:()=>{w(!1),C(null)},children:"Cancel"}),e.jsx(o,{type:"submit",variant:"primary",className:"hover:shadow-sky-500/40",isLoading:X.isPending||Y.isPending,children:S?"Save Changes":"Create Snippet"})]})]})}),L&&A&&e.jsx(x,{isOpen:L,onClose:()=>{_(!1),E(null),q(null)},title:`AI Suggestion for "${A.title}"`,size:"xl",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-slate-700/50 border border-slate-600 rounded-md",children:[e.jsxs("h4",{className:"text-lg font-semibold text-sky-300 mb-2 flex items-center",children:[e.jsx(y,{className:"h-6 w-6 mr-2 text-sky-400"})," Suggested ","cleanup"===P?"Cleanup":"Fixes",":"]}),J.isPending||O?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(i,{}),e.jsx("p",{className:"ml-3 text-slate-300",children:"AI is thinking..."})]}):z?e.jsx("pre",{className:"whitespace-pre-wrap text-slate-200 text-sm bg-slate-800/70 p-3 rounded-md max-h-96 overflow-y-auto",style:{scrollbarWidth:"thin",scrollbarColor:"#4A5568 #1A202C"},children:z}):e.jsx("p",{className:"text-slate-400",children:"No suggestion available or an error occurred."})]}),e.jsx("p",{className:"text-xs text-slate-400 italic",children:"AI suggestions are for guidance only. Always review and test code changes."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(o,{variant:"secondary",onClick:()=>{_(!1),E(null),q(null)},children:"Close"}),z&&!O&&e.jsx(o,{variant:"primary",onClick:()=>{navigator.clipboard.writeText(z),h.success("Suggestion copied to clipboard!")},className:"hover:shadow-sky-500/40",children:"Copy Suggestion"})]})]})}),$&&W&&e.jsx(x,{isOpen:$,onClose:()=>{K(!1),B(null)},title:`Delete Snippet: "${W.title}"?`,size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-slate-300",children:"Are you sure you want to delete this snippet? This action cannot be undone."}),e.jsxs("div",{className:"bg-slate-700/50 p-3 rounded-md border border-slate-600",children:[e.jsxs("p",{className:"text-sm text-slate-400",children:[e.jsx("strong",{children:"Title:"})," ",W.title]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[e.jsx("strong",{children:"Language:"})," ",W.language]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(o,{variant:"secondary",onClick:()=>{K(!1),B(null)},children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:()=>{W&&(G.mutate(W._id),K(!1),B(null))},isLoading:G.isPending,className:"hover:shadow-red-500/40",children:"Yes, Delete Snippet"})]})]})})]})};export{S as SnippetsPage};
